{% extends 'base.html' %}
{% block content %}

<div class="estimator-wrapper">
    
    <div class="estimator-container">
        <div class="est-header">
            <div class="icon-circle">
                <i class="fas fa-calculator"></i>
            </div>
            <h2>AI Project Estimator</h2>
            <p>Configure your custom model below to receive an instant implementation estimate.</p>
        </div>

        <div class="est-grid">
            <div class="est-controls">
                
                <div class="control-group">
                    <label class="control-label">
                        <i class="fas fa-brain"></i> Type of Intelligence
                    </label>
                    <select id="modelType" class="form-select" onchange="calculateTotal()">
                        <option value="tabular">Tabular Analytics (Finance/Sales Prediction)</option>
                        <option value="vision">Computer Vision (Crop Scan/Medical Imaging)</option>
                        <option value="nlp">Natural Language (Chatbots/Swahili Translation)</option>
                        <option value="bio" selected>Bioinformatics (Genomic Sequencing)</option>
                    </select>
                    <p class="helper-text">Select the core technology required for your solution.</p>
                </div>

                <div class="control-group">
                    <div class="range-header">
                        <label class="control-label"><i class="fas fa-database"></i> Dataset Size</label>
                        <span class="range-value" id="sizeDisplay">50,000 Records</span>
                    </div>
                    <input type="range" id="dataSize" class="custom-range" min="1000" max="500000" step="1000" value="50000" oninput="calculateTotal()">
                    <div class="range-labels">
                        <span>1k</span>
                        <span>500k+</span>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label"><i class="fas fa-layer-group"></i> System Complexity</label>
                    <div class="radio-cards">
                        <label class="radio-card selected" onclick="selectRadio(this)">
                            <input type="radio" name="complexity" value="standard" checked onchange="calculateTotal()">
                            <div class="radio-info">
                                <span class="radio-title">Standard MVP</span>
                                <span class="radio-desc">Proof of concept, 85% accuracy target.</span>
                            </div>
                        </label>
                        <label class="radio-card" onclick="selectRadio(this)">
                            <input type="radio" name="complexity" value="advanced" onchange="calculateTotal()">
                            <div class="radio-info">
                                <span class="radio-title">Production Grade</span>
                                <span class="radio-desc">98% accuracy, scalable API, full docs.</span>
                            </div>
                        </label>
                    </div>
                </div>

            </div>

            <div class="est-summary">
                <div class="summary-card">
                    <h4>Estimated Investment</h4>
                    <h1 id="totalPrice">KSH 0.00</h1>
                    <p class="vat-note">+ VAT where applicable</p>
                    
                    <hr>
                    
                    <h5>What's Included:</h5>
                    <ul class="deliverables-list" id="deliverables">
                        </ul>

                    <button class="btn-primary w-100" onclick="handleLockIn()">
                        <i class="fas fa-file-contract"></i> Lock in Quote
                    </button>
                    <p class="secure-note"><i class="fas fa-lock"></i> Secure request. No payment required yet.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Layout */
    .estimator-wrapper {
        min-height: 85vh; /* Fixes footer issue */
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 40px 20px;
        background: #f8fafc;
    }

    .estimator-container {
        background: white;
        max-width: 900px;
        width: 100%;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.08);
        overflow: hidden;
        border: 1px solid #e2e8f0;
    }

    .est-header {
        background: #0f172a;
        color: white;
        padding: 40px;
        text-align: center;
    }
    .est-header h2 { margin: 15px 0 10px; color: white; }
    .est-header p { color: #94a3b8; margin: 0; }
    .icon-circle {
        background: rgba(255,255,255,0.1);
        width: 60px; height: 60px;
        border-radius: 50%;
        display: inline-flex;
        align-items: center; justify-content: center;
        font-size: 1.5rem; color: #3b82f6;
    }

    /* Grid */
    .est-grid {
        display: grid;
        grid-template-columns: 1.5fr 1fr;
    }
    @media (max-width: 768px) { .est-grid { grid-template-columns: 1fr; } }

    /* Controls (Left) */
    .est-controls { padding: 40px; border-right: 1px solid #e2e8f0; }
    
    .control-group { margin-bottom: 30px; }
    .control-label {
        display: block; font-weight: 700; margin-bottom: 10px; color: #0f172a;
        display: flex; align-items: center; gap: 8px;
    }
    .control-label i { color: #3b82f6; }
    
    .form-select {
        width: 100%; padding: 12px; border-radius: 8px;
        border: 1px solid #cbd5e1; font-size: 1rem;
        background-color: #f8fafc;
    }
    .helper-text { font-size: 0.85rem; color: #64748b; margin-top: 6px; }

    /* Range Slider */
    .range-header { display: flex; justify-content: space-between; margin-bottom: 10px; }
    .range-value { font-weight: 700; color: #2563eb; }
    .custom-range { width: 100%; cursor: pointer; }
    .range-labels { display: flex; justify-content: space-between; font-size: 0.75rem; color: #94a3b8; }

    /* Radio Cards */
    .radio-cards { display: flex; flex-direction: column; gap: 15px; }
    .radio-card {
        border: 2px solid #e2e8f0;
        padding: 15px; border-radius: 10px;
        cursor: pointer; display: flex; align-items: center; gap: 15px;
        transition: 0.2s;
    }
    .radio-card:hover { border-color: #bfdbfe; background: #eff6ff; }
    .radio-card.selected { border-color: #2563eb; background: #eff6ff; }
    .radio-card input { display: none; } /* Hide actual radio button */
    .radio-title { display: block; font-weight: 700; color: #0f172a; }
    .radio-desc { font-size: 0.85rem; color: #64748b; }

    /* Summary (Right) */
    .est-summary { padding: 40px; background: #f1f5f9; display: flex; flex-direction: column; justify-content: center; }
    .summary-card { text-align: center; }
    .summary-card h4 { color: #64748b; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 1px; margin-bottom: 10px; }
    .summary-card h1 { color: #0f172a; font-size: 2.5rem; margin: 0; }
    .vat-note { font-size: 0.8rem; color: #94a3b8; margin-bottom: 20px; }
    
    .deliverables-list { text-align: left; list-style: none; padding: 0; margin: 20px 0; }
    .deliverables-list li { margin-bottom: 10px; font-size: 0.9rem; color: #334155; }
    .deliverables-list li i { color: #10b981; margin-right: 10px; }

    .btn-primary {
        background: #2563eb; color: white; padding: 15px;
        border: none; border-radius: 8px; font-weight: 700; cursor: pointer;
        width: 100%; transition: 0.3s; font-size: 1rem;
    }
    .btn-primary:hover { background: #1e40af; transform: translateY(-2px); }
    .secure-note { font-size: 0.75rem; color: #64748b; margin-top: 15px; display: flex; align-items: center; justify-content: center; gap: 6px; }

</style>

<script>
    // 1. Data Store for Pricing
    const PRICING = {
        base: {
            tabular: 45000,
            vision: 120000,
            nlp: 95000,
            bio: 180000 // Specialized work costs more
        },
        perRecord: 0.85, // KSH per record
        advancedMultiplier: 1.6 // 60% markup for advanced
    };

    function calculateTotal() {
        // Get Inputs
        const type = document.getElementById('modelType').value;
        const size = parseInt(document.getElementById('dataSize').value);
        const complexity = document.querySelector('input[name="complexity"]:checked').value;

        // Visual Updates
        document.getElementById('sizeDisplay').innerText = size.toLocaleString() + " Records";
        
        // Math
        let total = PRICING.base[type] + (size * PRICING.perRecord);
        
        if (complexity === 'advanced') {
            total = total * PRICING.advancedMultiplier;
        }

        // Round to nearest 100 for neatness
        total = Math.ceil(total / 100) * 100;

        // Render Price
        document.getElementById('totalPrice').innerText = "KSH " + total.toLocaleString();

        // Render Deliverables List based on selection
        updateDeliverables(type, complexity);
    }

    function updateDeliverables(type, complexity) {
        const list = document.getElementById('deliverables');
        let items = [
            `Custom ${type.toUpperCase()} Architecture`,
            "Data Pre-processing & Cleaning",
        ];

        if (complexity === 'standard') {
            items.push("85% Target Accuracy", "Basic Web Interface", "1 Month Support");
        } else {
            items.push("98% Target Accuracy", "REST API Deployment", "Cloud Integration (AWS/GCP)", "3 Months Priority Support");
        }

        list.innerHTML = items.map(item => `<li><i class="fas fa-check-circle"></i> ${item}</li>`).join('');
    }

    // Handle Radio Selection Styling
    function selectRadio(element) {
        document.querySelectorAll('.radio-card').forEach(el => el.classList.remove('selected'));
        element.classList.add('selected');
    }

    // Initialize on load
    document.addEventListener('DOMContentLoaded', calculateTotal);

    function handleLockIn() {
        const price = document.getElementById('totalPrice').innerText;
        // You can replace this alert with a redirect to your contact page
        // window.location.href = `/contact?quote=${price}`;
        alert(`Success! We have generated a quote request for ${price}. Connecting to WhatsApp...`);
    }
</script>

{% endblock %}